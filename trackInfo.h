#include "musicNoteFreqs.h"

// I2C synth addresses
const int addrSyn1 = 02;
const int addrSyn2 = 03;

const int pRock1Length = 73; // used for array definition
const int pRock2Length = 124;

//                                   1     |     |  par|   ty| rock|   is|   in|  the|house|     |     |   to|night|     |     |     |     |     |   ev|  ery|   bo|   dy| just|     | have|    a| good|     | time|     |     |     |     2     |     |  and|   we|  gon| make|  you| lose|     |     | your| mind|     |     |     |     |     |   ev|  ery|   bo|   dy| just|     | have|    a| good|     | time|     |     |     |     3     |  par|   ty| rock|   is|   in|  the|house|     |     |   to|night|     |     |     |     |     |   ev|  ery|   bo|   dy| just|     | have|    a| good|     | time|     |     |     4     |     |  and|   we|  gon| make|  you| lose|     |     | your| mind|     |     |     |     |     |     |   we| just|  wan|   na|  see|  you|     |     |     |     |     |     |shake| that|     |>
PROGMEM prog_uint16_t pRock1Key[]  = {              kC5,  kC5, kDs4, kDs4, kDs4, kDs4, kDs5,             kDs5, kCs5,                               kGs4, kAs4,  kC5, kAs4, kGs4,       kDs4, kDs4, kAs4,       kGs4,                                      kC5, kDs4, kDs4, kDs4, kDs4, kDs5,             kDs5, kCs5,                               kGs4, kAs4,  kC5, kAs4, kGs4,       kDs4, kDs4, kAs4,       kGs4,                                kC5,  kC5, kDs4, kDs4, kDs4, kDs4, kDs5,             kDs5, kCs5,                               kGs4, kAs4,  kC5, kAs4, kGs4,       kDs4, kDs4, kAs4,       kGs4,                                kC5, kDs4, kDs4, kDs4, kDs4, kDs5,             kDs5, kCs5,                                     kGs4, kAs4,  kC5, kAs4, kGs4, kAs4,  kG5,     kG5,    kGs5,             kGs4,  kF4,   -1};
PROGMEM prog_uint16_t pRock1Tick[] = {                4,    6,    8,   10,   12,   14,   16,               22,   24,                                 36,   38,   40,   42,   44,         48,   50,   52,         56,                                       70,   72,   74,   76,   78,   80,               86,   88,                                100,  102,  104,  106,  108,        112,  114,  116,        120,                                132,  134,  136,  138,  140,  142,  144,              150,  152,                                164,  166,  168,  170,  172,        176,  178,  180,        184,                                198,  200,  202,  204,  206,  208,              214,  216,                                      228,  230,  232,  234,  236,  238,  240,     243,     246,              252,  254,  256};
PROGMEM prog_uint16_t pRock1Dura[] = {                2,    1,    2,    1,    2,    1,    5,                2,    8,                                  2,    2,    2,    1,    2,          2,    1,    3,          7,                                        2,    1,    1,    1,    1,    5,                2,    8,                                  2,    2,    2,    1,    2,          2,    1,    3,          7,                                  2,    1,    2,    1,    2,    1,    5,                2,    8,                                  2,    2,    2,    1,    2,          2,    1,    3,          7,                                  2,    1,    1,    1,    1,    5,                2,    8,                                        2,    2,    2,    1,    2,    1,    2,       2,       2,                1,    1,   -1};
//                                   1     |     |  par|   ty| rock|   is|   in|  the|house|     |     |   to|night|     |     |     |     |     |   ev|  ery|   bo|   dy| just|     | have|    a| good|     | time|     |     |     |     2     |     |  and|   we|  gon| make|  you| lose|     |     | your| mind|     |     |     |     |     |   ev|  ery|   bo|   dy| just|     | have|    a| good|     | time|     |     |     |     3     |  par|   ty| rock|   is|   in|  the|house|     |     |   to|night|     |     |     |     |     |   ev|  ery|   bo|   dy| just|     | have|    a| good|     | time|     |     |     4     |     |  and|   we|  gon| make|  you| lose|     |     | your| mind|     |     |     |     |     |   we| just|  wan|   na|  see|  you|     |     |  .  |     |     |     |     |shake| that|     |>
PROGMEM prog_uint16_t pRock2Key[]  = {  kF2,  kF3,  kF2,  kF3,  kF2,  kF3,  kF2,  kF3, kDs2, kDs3, kDs2, kDs3, kCs2, kCs3, kCs2, kCs3,  kF2,  kF3,  kF2,  kF3,  kF2,  kF3,  kF2,  kF3, kDs2, kDs3, kDs2, kDs3, kCs2, kCs3, kCs2, kCs3,  kF2,  kF3,  kF2,  kF3,  kF2,  kF3,  kF2,  kF3, kDs2, kDs3, kDs2, kDs3, kCs2, kCs3, kCs2, kCs3,  kF2,  kF3,  kF2,  kF3,  kF2,  kF3,  kF2,  kF3, kDs2, kDs3, kDs2, kDs3, kCs2, kCs3, kCs2, kCs3,  kF2,  kF3,  kF2,  kF3,  kF2,  kF3,  kF2,  kF3, kDs2, kDs3, kDs2, kDs3, kCs2, kCs3, kCs2, kCs3,  kF2,  kF3,  kF2,  kF3,  kF2,  kF3,  kF2,  kF3, kDs2, kDs3, kDs2, kDs3, kCs2, kCs3, kCs2, kCs3,  kF2,  kF3,  kF2,  kF3,  kF2,  kF3,  kF2,  kF3, kDs2, kDs3, kDs2, kDs3, kCs2, kCs3, kCs2, kCs3,  kF2,  kF3,  kF2,  kF3,  kF2,  kF3,  kF2,  kF3, kDs2,    kDs2,    kCs2,                           -1};
PROGMEM prog_uint16_t pRock2Tick[] = {    0,    2,    4,    6,    8,   10,   12,   14,   16,   18,   20,   22,   24,   26,   28,   30,   32,   34,   36,   38,   40,   42,   44,   46,   48,   50,   52,   54,   56,   58,   60,   62,   64,   66,   68,   70,   72,   74,   76,   78,   80,   82,   84,   86,   88,   90,   92,   94,   96,   98,  100,  102,  104,  106,  108,  110,  112,  114,  116,  118,  120,  122,  124,  126,  128,  130,  132,  134,  136,  138,  140,  142,  144,  146,  148,  150,  152,  154,  156,  158,  160,  162,  164,  166,  168,  170,  172,  174,  176,  178,  180,  182,  184,  186,  188,  190,  192,  194,  196,  198,  200,  202,  204,  206,  208,  210,  212,  214,  216,  218,  220,  222,  224,  226,  228,  230,  232,  234,  236,  238,  240,     243,     246,                          256};
PROGMEM prog_uint16_t pRock2Dura[] = {    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,    2,       2,       2,                           -1};

//                                   | 0    1   2    3   4  5  |  6    7    8    9  |  10   11  | 12  13   14   15   16  |  17   18  |  19   20  |  21   22  | 23   24  25   26   27   28   29   30  31   32  |  33   34  | 35   36  37   38   39   40   41  42   43  | 44   45   46   47  | 48   49   50   51  | 52   53   54   55  | 56   57   58   59  | 60   61   62   63   64   65  | 66  67   68   69   70  |  71  | 72   73   74   75   76  | 77   78  79   80   81   82   83  84   85  | 86   87   88   89   90  | 91  92   93   94  |  95   96   97  |  98   99  100  | 101  |102  103 104  105  106  107  108 109  110  | 111  112  |113  114 115  116  117  118  119  120 121  122  |123  124  125  126  |127  128  129  130  |131  132  133  134  |135  136  137  138  |139  140  141  142  143  144  |145 146  147  148  149  | 150  |151  152  153  154  155  |156  157 158  159  160  161  162 163  164|
PROGMEM prog_uchar    speakData[]  = {20, 127, 21, 120, 23, 4,   22, 130, 199, 152,   174, 128,   22, 78, 148, 135, 197,   129, 187,   129, 141,   190, 134,   21, 110, 22, 156, 184, 163, 185, 188, 21, 120,   192, 160,   21, 110, 22, 139, 141, 157, 191, 21, 120,   22, 103, 131, 166,   22, 117, 148, 128,   22, 130, 171, 133,   22, 117, 177, 128,   22, 103, 165, 134, 187, 191,   22, 78, 184, 132, 166,   134,   22, 117, 178, 134, 177,   21, 110, 22, 103, 192, 155, 140, 21, 120,   22, 130, 132, 141, 176,   22, 82, 185, 128,   179, 134, 142,   140, 154, 196,   160,   21, 100, 22, 156, 145, 139, 188, 21, 120,   128, 153,   21, 110, 22, 139, 140, 157, 141, 176, 21, 120,   22, 103, 131, 166,   22, 117, 148, 128,   22, 130, 171, 133,   22, 117, 177, 128,   22, 103, 165, 134, 187, 191,   22, 78, 184, 132, 166,   134,   22, 117, 178, 134, 177,   21, 110, 22, 103, 192, 155, 140, 21, 120};
//                                   |[volume] [speed ] [bend] | [pitch ]   p   ar  |   t    y  | [pitch]   r    o   ck  |   i    s  |   i    n  |  th    e  | [slow  ]  [pitch]   h    o    u   se  [fast  ] |   t    o  | [slow  ] [pitch ]   n    i  ght  [fast  ] | [pitch ]   e    v  | [pitch ]  er    y  | [pitch ]   b    o  | [pitch ]   d    y  | [pitch ]   j    u    s    t  | [pitch]   h    a   ve  |   a  | [pitch ]   g   oo    d  | [ slow ]  [pitch ]   t    i  me  [ fast ] | [pitch ]   a    n    d  | [pitch]   w    e  |   g    o    n  |   m    a   ke  | you  | [ slow ] [pitch ]   l    o   se  [ fast ] |   y  our  | [ slow ] [pitch ]   m    i    n    d  [ fast ] | [pitch ]   e    v  | [pitch ]  er    y  | [pitch ]   b    o  | [pitch ]   d    y  | [pitch ]   j    u    s    t  | [pitch]   h    a   ve  |   a  | [pitch ]   g   oo    d  | [ slow ] [pitch ]   t    i   me  [ fast]|>
const int speakDataLen = sizeof(speakData);

//                                   1     |     |  par|   ty| rock|   is|   in|  the|house|     |     |   to|night|     |     |     |     |     |   ev|  ery|   bo|   dy| just|     | have|    a| good|     | time|     |     |     |     2     |     |  and|   we|  gon| make|  you| lose|     |     | your| mind|     |     |     |     |     |   ev|  ery|   bo|   dy| just|     | have|    a| good|     | time|     |     |     |     3     |  par|   ty| rock|   is|   in|  the|house|     |     |   to|night|     |     |     |     |     |   ev|  ery|   bo|   dy| just|     | have|    a| good|     | time|     |     |     4     |     |  and|   we|  gon| make|  you| lose|     |     | your| mind|     |     |     |     |     |   we| just|  wan|   na|  see|  you|     |     |  .  |     |     |     |     |shake| that|     |>
PROGMEM prog_uint16_t speakTick[]  = {    0,          4,    6,    8,   10,   12,   14,   16,               22,   24,                                 36,   38,   40,   42,   44,         48,   50,   52,         56,                                       70,   72,   74,   76,   78,   80,               86,   88,                                100,  102,  104,  106,  108,        112,  114,  116,        120,                                                                                                                                                                                                                                                                                                                                                                                                                    256};
PROGMEM prog_uint16_t speakIndex[] = {    0,          6,   10,   12,   17,   19,   21,   23,               33,   35,                                 44,   48,   52,   56,   60,         66,   71,   72,         77,                                       86,   91,   95,   98,  101,  102,              111,  113,                                123,  127,  131,  135,  139,        145,  150,  151,        156,                                                                                                                                                                                                                                                                                                                                                                                                                    speakDataLen};


int firstTick = 0;
int finalTick = 128;

int bpm = 130;
int ticksPerBeat = 4;
int msPerTick = (60000 / bpm) / ticksPerBeat;

long currTick = firstTick - 1;
long lastTick = firstTick - 1;
long lastTickMs = 0;

int pRock1Pos = 0;
int pRock2Pos = 0;
int speakPos = 0;
int pRock1NoteOffTick = -1;
int pRock2NoteOffTick = -1;